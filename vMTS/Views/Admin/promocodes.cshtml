@model vMTS.Models.PromoCodes

@{Layout = "~/Views/Shared/_LayoutAdmin.cshtml";}

@Scripts.Render("~/bundles/admin_PromoCodes")

@{var itemList = @Model.AllCodes.ToList();}

@{var first = itemList[0].PromoCode;}


@if (itemList.Count() >= 1)
{
    <h2>Current Promo Codes</h2>
    <div class="container-fluid">
        <div class="table-bordered table-responsive">
            <table class="table table-condensed">
                @*<tr>
                    <td>
                        <button id="AddNew" type="button" class="btn btn-default" aria-label="Left Align">
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add New Code
                        </button>
                    </td>
                </tr>*@
                <tr>
                    <th>Promo Code</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Value</th>
                    <th>Status</th>
                    @*<th>&nbsp;</th>*@
                </tr>
                @foreach (var i in itemList)
                {
                    <tr>
                        <td><span id="@i.PromoCode">@i.PromoCode</span></td>
                        <td>@string.Format("{0:d}", i.StartDate)</td>
                        <td>@string.Format("{0:d}", i.EndDate)</td>
                        <td>@string.Format("{0:c}", i.Value.ToString())</td>
                        @if (i.Valid == true)
                        {
                            <td><span id="@i.PromoCode" class="glyphicon glyphicon-thumbs-up" aria-hidden="true" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="left" data-content="Promo code is active. Edit promo codes data file to make inactive and change properties of this code." data-original-title="" title="Status: Active"></span></td>
                            @*<td><span id="@i.PromoCode" class="glyphicon glyphicon-ok-sign" aria-hidden="true" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="left" data-content="Promo code is active. Edit promo codes data file to make inactive and change properties of this code." data-original-title="" title="Status: Active"></span></td>*@
                        }
                        else
                        {
                            <td><span id="@i.PromoCode" class="glyphicon glyphicon-lock" aria-hidden="true" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="left" data-content="Promo code is NOT active.  Edit promo codes data file to change properties of this code." data-original-title="" title="Status: Inactive"></span></td>

                            @*<td><span id="@i.PromoCode" class="glyphicon glyphicon-remove-sign" aria-hidden="true" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="left" data-content="Promo code is NOT active.  Edit promo codes data file to change properties of this code." data-original-title="" title="Status: Inactive"></span></td>*@
                        }
                        @*<td><span id="@i.PromoCode" class="glyphicon glyphicon-pencil" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="right" data-content="@i.PromoCode promo code.  Click to view/edit." data-original-title="" title="Promo Codes">&nbsp;</span>
                    *@</tr>
                }
            </table>
        </div>

        <div class="well well-small">
            <h3>Instructions for updating promo codes</h3>
            <ul class="list-group">
                <li class="list-group-item">Download file from FTP server</li>
                <li class="list-group-item">Make needed changes to the file</li>
                <li class="list-group-item">Upload (save) file to FTP server</li>
            </ul>

            <p class="lead">The data file can be found here: <a href="ftp://learntor:vmts2015@ftp.learntoridetn.com/Views/Admin/Settings/" target="_blank">ftp://ftp.learntoridetn.com/Views/Admin/Settings/PromoCode.json</a></p>

            <p class="initialism">You may have to enter user credentials to access the information.</p>
        </div>
    </div>

    @*<input type="hidden" id="promoCode" name="promoCode" />


    <div id="PromoCodeMgtForm" class="modal fade" role="dialog" aria-labelledby="modalTitle" tabindex="-1">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="modalTitle">Promo Code Management</h4>
                </div>
                <div class="modal-body text-center">
                    <div id="loading">
                        @Html.Partial("_promocodemgt", Model)
                    </div>
                    <div id="alertText" class="lead hidden"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <div id="PromoCodeEditForm" class="modal fade" role="dialog" aria-labelledby="modalTitle" tabindex="-1">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="modalTitle">Promo Code Management</h4>
                </div>
                <div class="modal-body text-center">
                    <div id="loading">
                    </div>
                    <div id="editForm">

                    </div>
                    <div id="resultText" class="lead hidden"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->*@

}

